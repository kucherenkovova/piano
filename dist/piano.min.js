!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.piano=e():t.piano=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n,i){t.style["-webkit-transform"]="scale("+e+")",t.style["-moz-transform"]="scale("+e+")",t.style["-ms-transform"]="scale("+e+")",t.style["-o-transform"]="scale("+e+")",t.style.transform="scale("+e+")",t.style["-webkit-transform-origin"]=n+" "+i,t.style["-moz-transform-origin"]=n+" "+i,t.style["-ms-transform-origin"]=n+" "+i,t.style["-o-transform-origin"]=n+" "+i,t.style["transform-origin"]=n+" "+i}function o(t,e,n,i){return t.slice(0,e)+(i||"")+t.slice(e+n)}function s(t,e,n){t=t instanceof Array?t:[t];for(var i=0;i<t.length;i++)e.addEventListener(t[i],function(t){n(t)})}function a(t,e,n){var i;return function(){var o=this,s=arguments,a=function(){i=null,n||t.apply(o,s)},r=n&&!i;clearTimeout(i),i=setTimeout(a,e||200),r&&t.apply(o,s)}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(){function t(e){return n(this,t),document.querySelectorAll("#piano").length?(console.warn("piano is already initialized"),!1):(this.defaults={triggerEvents:["click"],slideContent:!1,slideContainer:"body",onBeforeHidden:function(){},onHidden:function(){},layouts:e.layouts||[],autohide:!0},this.settings=l(this.defaults,e),this.container=l(document.createElement("div"),{id:"piano",className:"piano-container animated"}),this.detectInputs(),document.body.appendChild(this.container),void(this.settings.autohide&&s(["click","touchdown"],document,function(t){""===t.target.dataset.piano||this.container.contains(t.target)||this.hideKeyboard()}.bind(this))))}return c(t,[{key:"detectInputs",value:function(){var t=this,e=function(e,n){var i=l({},e);delete i.triggers,delete i.layouts;var o=n.dataset,a={};i.shift=!1,o.pianoPosition?o.pianoPosition.indexOf("absolute")>-1?a.position=o.pianoPosition.replace(/absolute,\s/gi,"").split(","):a.position=o.pianoPosition?o.pianoPosition.split(","):[]:(console.warn("It seems you have incorrect values in your data-piano-position attribute on element: ",n),a.position=[]),a.layout=o.pianoLayout,a.limit=o.pianoLimit,a.animationIn=o.pianoAnimationIn,a.animationOut=o.pianoAnimationOut,a.scale=o.pianoScale;var r=o.pianoEventId,c=null;r&&(c=document.createEvent("Event"),c.initEvent(r,!0,!0)),i.settings={position:{x:a.position[0]||"center",y:a.position[1]||"bottom"},layout:a.layout||"default",limit:a.limit||-1,submitEvent:c,animationIn:a.animationIn||"fadeInUp",animationOut:a.animationOut||"fadeOutDown",scale:a.scale||1},s(["click","touchdown"],n,function(t){this.clearKeyboards(),this.currentTarget=t.target,this.displayKeyboard(i)}.bind(t))};this.triggers=document.querySelectorAll("[data-piano]");for(var n=this.triggers.length,i=0;n>i;i++)e(this,this.triggers[i])}},{key:"displayKeyboard",value:function(t){var e=this;e.currentKeyboard=t;var n=document.createElement("div");n.className="piano-rows";var o=this.settings.layouts[t.settings.layout],l=[];l.push(document.createElement("ul"));for(var c in o){var u=document.createElement("li");if("break"==o[c])n.appendChild(l[l.length-1]),l.push(document.createElement("ul"));else{var d=document.createElement("button");"object"===r(o[c][0])?(u.className=o[c][0].name,d.className="key "+o[c][0].name,d.innerHTML=o[c][0].value,d.dataset.pianoKey=o[c][0].name):(d.className="key "+o[c],d.textContent=o[c][0],d.dataset.pianoKey=o[c][0]),s(e.settings.triggerEvents,d,function(t){a(this.keyPressed(t),300,!1)}.bind(this)),u.appendChild(d)}n.appendChild(l[l.length-1]),l[l.length-1].appendChild(u)}isNaN(t.settings.position.x)||isNaN(t.settings.position.y)?(this.container.className+=" "+t.settings.position.x,this.container.className+=" "+t.settings.position.y):(this.container.style.left=t.settings.position.x+"px",this.container.style.top=t.settings.position.y+"px"),this.container.style.display="block",this.container.classList.remove(this.currentKeyboard.settings.animationOut),this.container.appendChild(n),this.container.classList.add(this.currentKeyboard.settings.animationIn);var p=e.currentKeyboard.settings.scale;if(p>1){var y=e.currentKeyboard.settings.position.x,h=e.currentKeyboard.settings.position.y;i(n,p,y,h)}document.body.classList.add("piano-open"),this.slideContent&&(document.querySelector(this.slideContainer).style.top="-"+n.getBoundingClientRect().height/2+"px")}},{key:"keyPressed",value:function(t){var e=t.target,n=e.textContent,i=this.currentTarget,s=i.selectionStart,a=i.selectionEnd,r=a-s||1,l=t.target.innerText.length,c=this.currentKeyboard.settings.limit,u=this.currentKeyboard.settings.submitEvent;if(/del/i.test(e.className)){var d=s?-1:0;i.value=o(i.value,s+d,r,""),l=-1}else/space/i.test(e.className)?(i.value.length<=c||-1===c)&&(i.value=o(i.value,s,r-1," ")):/shift/i.test(e.className)?this.switchCase():/larr/i.test(e.className)?l=-1:/rarr/i.test(e.className)?l=1:/hide/i.test(e.className)?this.hideKeyboard():/submit/i.test(e.className)?u?i.dispatchEvent(u):console.warn("You did not provide a data-piano-event-id attribute."):(i.value.length<=c||-1===c)&&(i.value=o(i.value,s,r-1,n));if(i.selectionStart=s+l,i.selectionEnd=s+l,document.createEvent){var p=document.createEvent("HTMLEvents");p.initEvent("input",!1,!0),i.dispatchEvent(p)}else i.fireEvent("input");i.focus()}},{key:"switchCase",value:function(){for(var t=this.currentKeyboard.shift=!this.currentKeyboard.shift,e=document.querySelectorAll(".piano-rows > ul > li"),n=this.settings.layouts[this.currentKeyboard.settings.layout],i=e.length,o=0;i>o;o++){var s=e[o].children[0];if(s){var a=s.textContent;n[o].length>1&&n[o][0].length>0?s.textContent=t?n[o][1]:n[o][0]:s.textContent=t?a.toUpperCase():a.toLowerCase()}}}},{key:"hideKeyboard",value:function(){var t=this;this.container.firstChild&&("function"==typeof this.onBeforeHidden&&this.onBeforeHidden(),this.container.classList.remove(this.currentKeyboard.settings.animationIn),this.container.classList.add(this.currentKeyboard.settings.animationOut),setTimeout(function(){t.container.style.display="none"},+this.container.style.animationDuration),document.body.classList.remove("piano-open"),this.slideContent&&(document.querySelector(this.slideContainer).style.top=0),"function"==typeof this.onHidden&&this.onHidden())}},{key:"clearKeyboards",value:function(){this.container.firstChild&&(this.container.firstChild.remove(),this.container.style.top=this.container.style.left="",this.container.className="piano-container animated",this.currentKeyboard=null,document.body.classList.remove("piano-open"),this.slideContent&&(document.querySelector(this.slideContainer).style.top=0))}},{key:"isOpen",value:function(){return null!==document.body.className.match(/\piano-open\b/)}},{key:"destroy",value:function(){this.clearKeyboards(),this.container.remove()}}]),t}();t.exports=u}])});
//# sourceMappingURL=piano.min.js.map
